<div class="card mx-auto">
    <div class="card-header">
        Live Data
    </div>
    <div class="card-body">
        <div class="d-flex flex-wrap justify-content-center" style="gap: 1rem">
            {% if sensors|length > 0 %}
                {% for sensor in sensors %}
                    <div class="justify-content-center mx-auto" >
                        <h6>{{sensor['name']}}</h6>
                        <canvas id="chart_{{sensor['pid']}}" class="Chart" ></canvas>
                    </div>
                {% endfor %}
            {% else %}
                <p>No sensors could be loaded. Check the vehicle connection and try again.</p>
            {% endif %}
        </div>

        <div class="d-flex">
            <input type="button" id="btnStart" onclick="btnStart()" value="Start"/>
            <input class="ms-auto" type="button" id="btnBack" value="Back" onclick="navCard('/static/card/start.html')"/>
        </div>
    </div>
</div>

<script>
    var charts = [];
    var maxPoints = 20;

    var sensors = {{ sensors|tojson }};

    for (var sensor of sensors) {
        charts[sensor.pid] = CreateChart(
            $('#chart_' + sensor.pid),
            sensor.name,
            0, 100, maxPoints
        )
    }

    socketio.on('send_data', (data) => {
        for (sensor of data) {
            console.log(sensor)
            updateChart(
                charts[sensor.pid],
                sensor.val,
                sensor.elapsed
            )
        }
    });

    function btnStart() {
        socketio.emit('start_logging')
    }


</script>